<% provide(:title, "#{@question.title}") %>
<div class="question-show-wrapper" >
 <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1><%= @question.title %></h1>
        <h2>質問者: <%= link_to @question.user.name, user_path(@question.user_id) %></h2>
        <div class="show-question">
          <p><%= simple_format(h(@question.content)) %></p>
        </div>
        <% if @question.status == 1 and @question.user_id != @current_user.id %>
          <%# 自分以外の投稿した質問、かつ回答募集中 %>
          <%= link_to '回答する', new_answer_path(@question.id), class: 'btn btn-block btn-black' %>
        <% elsif @question.user_id == @current_user.id %>
          <%= link_to '質問を編集する', edit_question_path(@question.id), class: 'btn btn-block btn-black' %>
        <% else %>
          <p>回答を締め切りました。</p>
        <% end %>
        <% if @question.answers.empty? %>
          <p>回答はありません。</p>
        <% else %>
          <% @question.answers.reverse.each_with_index do |a, i| %>
            <div class="show-answer">
              <h3>回答 #<%= @answers.length - i %> 回答者:<%= link_to a.user.name, user_path(a.user_id) %></h3>
              <p><%= simple_format(h(a.content)) %></p>
              <% if !a.answer_reply.nil? %>
                <div class="reply-container">
                  <%# 回答への返信があれば表示する %>
                  <p><strong>返信</strong></p>
                  <%= simple_format(h(a.answer_reply.content)) %>
                </div>
              <% elsif @question.user_id == @current_user.id %>
                <%= link_to '返信する', new_reply_path %>
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
